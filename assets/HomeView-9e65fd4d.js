import{d as B,o as f,c as w,a as t,t as n,r as T,u as z,b as H,e as M,f as P,g as v,h as R,i as U,j as o,k as e,l as c,m as E,n as I,w as l,A as J,_ as O,p as $,q as C,s as L,v as q,x as G}from"./index-6b4296aa.js";function K(y){return Intl.NumberFormat("en-US",{currency:"USD",maximumSignificantDigits:4,notation:"compact"}).format(y)}const Q={class:"d-flex align-items-center px-md-3 border-bottom border-dark statictic-wrapper px-0 py-3"},X={class:"d-flex justify-content-center align-items-center statictic-avatar flex-shrink-0"},Y={class:"d-flex flex-column statictic-content"},Z={class:"statictic-content-title"},tt={class:"statictic-content-subtitle mt-1 text-white"},k=B({__name:"AppStatistic",props:{initial:{},label:{},value:{},isLoading:{type:Boolean}},setup(y){return(u,p)=>(f(),w("div",Q,[t("div",X,n(u.initial),1),t("div",Y,[t("div",Z,n(u.label),1),t("div",tt,n(u.isLoading?"...":u.value),1)])]))}}),st={class:"d-flex flex-column flex-grow-1"},at={class:"position-relative pb-5",id:"hero"},et={class:"container"},ot={class:"row statictic my-4 py-3"},nt={class:"col-12 col-lg-6"},lt={class:"row"},it={class:"col-6 p-3"},ct={class:"d-flex justify-content-between align-items-center"},rt=t("div",{class:"custom-border-right d-none d-md-block"},null,-1),dt={class:"col-6 p-3"},ut={class:"d-flex justify-content-between align-items-center"},_t=t("div",{class:"custom-border-right d-none d-md-block"},null,-1),ht={class:"position-relative col-12 col-lg-6 mt-lg-0 mt-4"},vt={class:"position-absolute"},gt={class:"bg-linear text-clip"},mt={id:"transactions"},bt={class:"container"},ft={class:"row"},pt={class:"col-12 col-lg-6"},xt={class:"mb-3"},kt={class:"list"},wt={class:"d-flex flex-column"},yt={class:"text-white"},St={class:"d-flex flex-column"},Tt={class:"text-white"},$t={class:"col-12 col-lg-6 mt-lg-0 mt-5"},Ct={class:"d-flex justify-content-between align-items-center"},Lt={class:"mb-3"},Bt={key:0,style:{"font-size":"12px"}},Vt={key:1,style:{"font-size":"12px"}},Nt={class:"list"},jt={class:"d-flex flex-column"},At={class:"text-white"},Dt={class:"d-flex flex-column"},Ft={class:"d-flex flex-column"},zt=B({__name:"HomeView",setup(y){const u=q(),p=G(),V=T([{key:"block",label:"Block",align:"left",slot:!0},{key:"validated",label:"Validated",align:"left",slot:!0},{key:"reward",label:"Block Reward",align:"right",slot:!0}]),N=T([{key:"hash",label:"Txn Hash",align:"left",slot:!0},{key:"from",label:"From",align:"left",slot:!0},{key:"value",label:"Value",align:"right",slot:!0}]),S=T(0),j=z(),A=H(),g=M(),x=P();v(()=>j.data),v(()=>A.data.search);const r=v(()=>g.$state),h=v(()=>x.$state),D=v(()=>{var i,a;const d=(i=h.value)==null?void 0:i.blocks.data.length;return((a=h.value)==null?void 0:a.transactions.data.slice(0,d))||[]}),F=v(()=>{var d;return(d=g.statChartTxs.data.chartData)==null?void 0:d.map(i=>i.date).reverse()}),W=v(()=>{var d;return(d=g.statChartTxs.data.chartData)==null?void 0:d.map(i=>i.txCount).reverse()});return R(async()=>{await g.getStats(),await g.getStatChartTxs(),await g.getStatChartMarket(),await x.fetchTxs(),await x.fetchIndexingStatus(),await x.fetchBlocks();const d="ws://http://45.77.40.194:8546",i=new WebSocket(`${d}/socket/v2/websocket?vsn=2.0.0`);i.onopen=()=>{function a(s){i.send(JSON.stringify(s))}a(["5","5","transactions:new_transaction","phx_join",{}]),a(["8","8","blocks:new_block","phx_join",{}])},i.onerror=a=>{window.console.error(`WebSocket error ${a}`),window.console.dir(a)},i.onmessage=({data:a})=>{let s={};try{s=JSON.parse(a)}catch(_){console.error(`Error parsing : ${_.data}`)}s[2]==="transactions:new_transaction"&&s[4].transaction&&(S.value+=s[4].transaction)}}),(d,i)=>{const a=U("RouterLink");return f(),w("main",st,[t("section",at,[t("div",et,[o(e(J)),t("div",ot,[t("div",nt,[t("div",lt,[t("div",it,[t("div",ct,[t("div",null,[o(e(k),{initial:"A",label:"Average block time","is-loading":r.value.stats.isLoading,value:(r.value.stats.data.averageBlockTime/1e3).toFixed(1).toString()+" s"},null,8,["is-loading","value"]),o(e(k),{initial:"T",label:"Total blocks","is-loading":r.value.stats.isLoading,value:(+r.value.stats.data.totalBlocks).toLocaleString()},null,8,["is-loading","value"])]),rt])]),t("div",dt,[t("div",ut,[t("div",null,[o(e(k),{initial:"T","is-loading":r.value.stats.isLoading,label:"Transactions",value:(+r.value.stats.data.totalTransactions).toLocaleString()},null,8,["is-loading","value"]),o(e(k),{initial:"W",label:"Wallet addresses","is-loading":r.value.stats.isLoading,value:(+r.value.stats.data.totalAddresses).toLocaleString()},null,8,["is-loading","value"])]),_t])])])]),t("div",ht,[t("span",vt,[c("Daily txs "),t("strong",gt,n(e(K)(+r.value.stats.data.transactionsToday)),1)]),r.value.statChartTxs.isLoading?I("",!0):(f(),E(e(O),{key:0,"is-currency":!0,data:{labels:F.value,datasets:W.value}},null,8,["data"]))])])])]),t("section",mt,[t("div",bt,[t("div",ft,[t("div",pt,[t("h6",xt,"The latest "+n(h.value.blocks.data.length)+" Blocks",1),t("div",kt,[o(e(L),{columns:V.value,loading:h.value.blocks.isLoading,items:h.value.blocks.data},{block:l(({item:s})=>[t("div",wt,[o(a,{to:`/blocks/${s.height}`,class:"bg-linear text-clip"},{default:l(()=>[c(n(s.height),1)]),_:2},1032,["to"]),t("div",yt,[o(e($),{date:s.timestamp},null,8,["date"])])])]),validated:l(({item:s})=>[t("div",St,[o(a,{class:"bg-linear text-clip",to:`/accounts/${s.miner.hash}`},{default:l(()=>[c(n(e(u).truncate(s.hash)),1)]),_:2},1032,["to"]),t("div",Tt,n(s.txCount)+" transactions ",1)])]),reward:l(({item:s,column:_})=>{var m;return[t("p",{class:C(`text-${_.align}`)},n(e(p).getValue(String(((m=s.rewards[0])==null?void 0:m.reward)||"0"))),3)]}),_:1},8,["columns","loading","items"]),o(a,{to:"/blocks",class:"btn btn-primary btn-lg btn-block"},{default:l(()=>[c(" View all blocks ")]),_:1})])]),t("div",$t,[t("div",Ct,[t("h6",Lt,"The latest "+n(h.value.transactions.data.length)+" Transactions",1),S.value>0?(f(),w("p",Bt,[o(a,{to:"/transactions",class:"bg-linear text-clip"},{default:l(()=>[c(n(e(p).format(S.value))+" more transactions",1)]),_:1}),c(" Â  have come in ")])):(f(),w("p",Vt,"scanning new transactions..."))]),t("div",Nt,[o(e(L),{columns:N.value,loading:h.value.transactions.isLoading,items:D.value},{hash:l(({item:s})=>[t("div",jt,[o(a,{to:`/transactions/${s.hash}`,class:"bg-linear text-clip"},{default:l(()=>[c(n(e(u).truncate(s.hash)),1)]),_:2},1032,["to"]),t("div",At,[o(e($),{date:s.timestamp},null,8,["date"])])])]),from:l(({item:s})=>{var _,m;return[t("div",Dt,[t("div",Ft,[t("div",null,[c(" From "),o(a,{to:`/accounts/${(_=s.from)==null?void 0:_.hash}`,class:"bg-linear text-clip"},{default:l(()=>{var b;return[c(n(e(u).truncate(((b=s.from)==null?void 0:b.hash)||"")),1)]}),_:2},1032,["to"])]),t("div",null,[c(" To "),o(a,{to:`/accounts/${(m=s.to)==null?void 0:m.hash}`,class:"bg-linear text-clip"},{default:l(()=>{var b;return[c(n(e(u).truncate(((b=s.to)==null?void 0:b.hash)||"")),1)]}),_:2},1032,["to"])])])])]}),value:l(({item:s,column:_})=>[t("p",{class:C(`text-${_.align}`)},n(e(p).getValue(s.value)),3)]),_:1},8,["columns","loading","items"]),o(a,{to:"/transactions",class:"btn btn-primary btn-lg btn-block"},{default:l(()=>[c(" View all transactions ")]),_:1})])])])])])])}}});export{zt as default};
